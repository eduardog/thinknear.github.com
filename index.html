
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Thinknear Engineering</title>
  <meta name="author" content="Thinknear by Telenav">

  
  <meta name="description" content="During the early days of Thinknear, Resque was the most prevalent background job processor for our Rails applications.
However, Resque was not &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://engineering.thinknear.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Thinknear Engineering" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
<!-- <h1><a href="/">Thinknear Engineering</a></h1> -->
  <h1><a href="/"><img src="/images/LOGO_Thinknear_PNG_engineer_201408.png" alt="Thinknear Engineering" /></a></h1>
  
    <h2>Bid Data, High Frequency</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:engineering.thinknear.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/values">About us</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/06/heroku-cost-savings-using-generic-workers/">Heroku Cost Optimization Using Generic Workers</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-06T17:43:10-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>5:43 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>During the early days of Thinknear, <a href="https://github.com/resque/resque" target="_blank">Resque</a> was the most prevalent background job processor for our Rails applications.
However, Resque was not multithread-friendly, and, as our applications grew, this put a toll on our Heroku monthly bill.</p>

<p>We tried out <a href="http://sidekiq.org" target="_blank">Sidekiq</a>, really liked it, and now use it exclusively. Unlike Resque, Sidekiq supports multiple threads
working on multiple jobs concurrently.
According to Sidekiq&rsquo;s main developer, Mike Perham, one large Resque farm with a 68GB RAM footprint can be brought down to 1 GB RAM by using threads instead of processes.
[<a href="https://github.com/mperham/sidekiq/wiki/Internals" target="_blank"><em>source</em></a>]</p>

<p>We analyzed the distribution of background jobs across dynos.
We use a family of dynos for each queue, running up to 50 dynos per queue and different families being on for 750 hours per month at the low end, and up to to 40,000 hours
per month at the high end.</p>

<p>We utilize a home-grown type of autoscaling to dial up and down workers based on the jobs in the queue, since all dyno families needing it are background job focused.
Its simplicity provided long-term reliability.</p>

<p>While this setup fit the production processing needs, it was inefficient for non-production environments.
With 19 always on dyno families, and 3 non-production environments (sandbox, test, and integration) used 24/7 for unit, contract level and end-to-end integration testing,
something needed to change.</p>

<p>Sidekiq supports assigning multiple queues to a single worker process. In non-production environments, we assigned every queue to a single, generic worker and
noticed a couple of standard dynos are enough to process the non-production load.</p>

<p>As a result, we&rsquo;re now saving 90-95% on the Heroku bill of development and testing environments.</p>

<p>Sample Procfile:</p>

<p><code>web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb</code><br/>
<code>clock: bundle exec clockwork config/clock.rb</code></p>

<p><code>core_worker: bundle exec sidekiq -c 1 -q core</code><br/>
<code>creator_worker: bundle exec sidekiq -c 1 -q creator</code><br/>
<code>emr_worker: bundle exec sidekiq -c 1 -q emr</code><br/>
<code>maintenance_worker: bundle exec sidekiq -c 1 -q maintenance</code><br/>
<code>measure_worker: bundle exec sidekiq -c 1 -q measure</code></p>

<p><code>generic_worker: bundle exec sidekiq -c 1 -q core -q creator -q emr -q maintenance -q measure</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/26/typical-friday-night/">Typical Friday Night</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-26T15:09:23-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:09 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/25/presenting-at-reinvent/">Presenting at re:Invent</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-25T16:07:43-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:07 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Thinknear was priviledged to be invited to present at AWS re:Invent 2014. Our topic was on how we have scaled to billions of daily requests on Elastic Beanstalk. Here&rsquo;s a direct link to our agenda summary, <a href="https://www.portal.reinvent.awsevents.com/connect/sessionDetail.ww?SESSION_ID=8726">APP 402</a>.</p>

<p>You can check us out on the <a href="http://bit.ly/1qR0mEi">AWS YouTube Channel</a>. You can view our slides on <a href="http://www.slideshare.net/AmazonWebServices/app402?qid=0a3f4642-757a-484b-a850-c34b0cb8b865&amp;v=default&amp;b=&amp;from_search=1">Slideshare</a>. You can even listen to us as a podcast on <a href="https://itunes.apple.com/us/podcast/app402-serving-billions-web/id941313180?i=324951733&amp;mt=2">iTunes</a>.</p>

<p>Thank you, AWS, for inviting us.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/11/aws-templates-released/">Aws_templates Released</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-11T14:45:14-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:45 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Announcement</h2>

<p>Thinknear is releasing our <code>aws_templates</code> as an open-source project under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">APLv2</a>.
<code>aws_templates</code> is an example deployment and configuration setup for <a href="http://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a>.</p>

<p>You can visit the project&rsquo;s <a href="https://github.com/ThinkNear/aws_templates">GitHub page</a>. The README has more information on the features and behavior of the configuration.</p>

<h2>Motivation</h2>

<p>Thinknear&rsquo;s Elastic Beanstalk environments are low-latency, high-throughput systems serving billions of auction requests per day from dozens of exchanges.
The <code>aws_templates</code> works with Beanstalk&rsquo;s <code>.ebextensions</code> to configure EC2 instances with</p>

<ul>
<li>RAID 0</li>
<li>log rotation to AWS S3 using <a href="https://github.com/ThinkNear/tn_s3_file_uploader">tn_s3_file_uploader</a></li>
<li>collectd and JMX remote monitoring</li>
<li>AWS ELB configuration</li>
<li>Custom system settings</li>
</ul>


<p>This project is intended to share a method of deployment and configuration using a collection of scripts and Beanstalk&rsquo;s <code>.ebextensions</code>.</p>

<h2>Contribute</h2>

<p>Thinknear Engineering would like to invite anyone who finds <code>aws_templates</code> useful to contribute to the project. Visit the project&rsquo;s <a href="https://github.com/ThinkNear/aws_templates/issues">issue tracker page</a> to submit questions, bugs, or new features.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/11/tn-s3-file-uploader-released/">Tn_s3_file_uploader Released</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-11T13:01:58-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:01 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Announcement</h2>

<p>Thinknear is delighted to announce that our <code>tn_s3_file_uploader</code> is released as open-source under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">APLv2</a>. <code>tn_s3_file_uploader</code> is a Ruby gem that we use internally to upload log files to Amazon S3 where they can be stored until we need to retrieve them for further analysis or processing.</p>

<p>You can visit the gem&rsquo;s page on <a href="https://rubygems.org/gems/tn_s3_file_uploader">Ruby Gems</a>. Please, visit the project&rsquo;s <a href="https://github.com/ThinkNear/tn_s3_file_uploader/wiki/Getting-started">getting-started page</a> for more information on how to install and use the gem.</p>

<h2>Motivation</h2>

<p>Thinknear&rsquo;s <a href="http://en.wikipedia.org/wiki/Real-time_bidding">Real Time Bidding</a> service produces billions of log entries per day and we have set up a simple but robust pipeline around rotating those logs and storing them on <a href="http://aws.amazon.com/s3/">Amazon S3</a>. The two key parts of this pipeline have been released to the public as open-source software.</p>

<p>First our <a href="http://aws.amazon.com/elasticbeanstalk/?sc_channel=PS&amp;sc_campaign=beanstalk_awns&amp;sc_publisher=google&amp;sc_medium=beanstalk_b&amp;sc_content=elastic_beanstalk_e&amp;sc_detail=amazon%20elastic%20beanstalk&amp;sc_category=beanstalk&amp;sc_segment=177&amp;sc_matchtype=e&amp;sc_country=US&amp;s_kwcid=AL!4422!3!50999240322!e!!g!!amazon%20elastic%20beanstalk&amp;ef_id=VCxP0QAABUt7hwuO:20141111211834:s">AWS Elastic Beanstalk</a> <a href="https://github.com/ThinkNear/aws_templates">logrotate and config scripts</a> rotates the logs produced by our service.</p>

<p>Second the aforementioned ruby gem uploads the rotated logs on S3 with a year/month/day/hour <a href="https://github.com/ThinkNear/tn_s3_file_uploader/wiki/Getting-started#partition-uploaded-files-based-on-date">partitioned destination path</a> that makes it easy to retrieve and analyze the logs for a specific period of time.</p>

<h2>Contribute</h2>

<p>Thinknear Engineering values the openness of the open source software model and we would like to invite anyone that finds <code>tn_s3_file_uploader</code> useful to contribute. Visit the <a href="https://github.com/ThinkNear/tn_s3_file_uploader/issues">project&rsquo;s issue tracker page</a> to submit questions, bugs or new features.</p>

<p>If you want to hack around the code, <a href="https://github.com/ThinkNear/tn_s3_file_uploader/fork">fork the project on GitHub</a> and see the <a href="https://github.com/ThinkNear/tn_s3_file_uploader/wiki/Contribute">how to contribute page</a> if you want to submit your code to the project.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/21/monitoring-beanstalk-with-collectd/">Monitoring Beanstalk With Collectd</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-21T17:51:02-07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>5:51 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Our system</h2>

<p>Thinknear&rsquo;s <a href="http://en.wikipedia.org/wiki/Real-time_bidding">Real Time Bidding</a> service is built on <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/Welcome.html">AWS Elastic Beanstalk</a>.
We run around one-hundred instances to serve billions of auctions a day.
The system must be highly available, performant and maintain high success rates.
Operationally, engineers must be able to ship code throughout the week and change configurations without disrupting service.
We make data driven decisions to meet these standards by using metrics gathering systems like <a href="https://collectd.org/">collectd</a>.</p>

<blockquote><p>If you don&rsquo;t know where you are going, you&rsquo;ll end up someplace else &ndash; Yogi Berra</p></blockquote>

<p>If you run your services in the cloud, then you know there is a risk of overpaying.
There are a lot of factors that go into your cloud’s cost.
For example, we want to know when:</p>

<ul>
<li>We are under-utilizing instances.</li>
<li>Hosts are suffering from <a href="http://blog.scoutapp.com/articles/2013/07/25/understanding-cpu-steal-time-when-should-you-be-worried">steal time</a>.</li>
<li>We need a instance type that better suits our needs.</li>
</ul>


<p>Tracking memory, CPU and network statistics are key to meeting these goals and making sound decisions.
But we don&rsquo;t stop there.
There are multitudes of metrics to track.</p>

<h2>Measure everything</h2>

<p>At the instance level, AWS EC2 CloudWatch metrics from a Beanstalk environment didn&rsquo;t meet our needs.
CloudWatch provides CPU, Disk IO and Network IO; however, it lacks load, memory, fine-grained configurations and a method to extend the set of collected metrics.
Our engineering team needs more.
That is why we are users of the rock-solid statistics collection daemon collectd.</p>

<p>Collectd can track any system metric we want &ndash; the <a href="https://collectd.org/wiki/index.php/Table_of_Plugins">official plugins list</a> is extensive.
It works as a daemon running a loop over a set of plugins.
There is no graphing built into collectd so one must be configured.
<a href="http://graphite.readthedocs.org/en/1.0/tools.html">Graphite</a> is a popular frontend &ndash; but it only does graphing.
We like <a href="https://metrics.librato.com/">Librato</a>, a paid service, which has beautiful graphs, aggregates metrics and provides alerting similar to CloudWatch.</p>

<blockquote><p>Do not look where you fell, but where you slipped &ndash; African proverb</p></blockquote>

<p>We use collectd to track memory, load, cpu, network, JVM, process statistics and more.
Every Beanstalk host is deployed with a collectd installation as a standalone metric collector and reporter that is configured.
It is configured to report to Librato every minute.
This gives us the detailed performance tracking and a monitor for unexpected events.
When things go wrong, we can see what, when and how often an event happened.
When we make instance type changes, we can see exactly how we use system resources we need for each host.</p>

<h2>Getting started with Elastic Beanstalk and collectd</h2>

<p>Setting up collectd with Beanstalk is easy.
Below is a simple <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html">Elastic Beanstalk configuration</a> that will:</p>

<ol>
<li>Install collectd on your instances.</li>
<li>Create a basic collectd configuration file for collecting CPU, network IO, load and memory statistics.
It uses the write_http plugin to report to Librato.</li>
<li>Start and supervise collectd daemon with the collectdmon monitor process.
There are alternatives like <a href="http://mmonit.com/monit/">monit</a>, but we like collectdmon because it is installed with the collectd package.</li>
</ol>


<p>This configuration was tested on a 2014.03 Amazon Linux EC2 instance.
This version of Amazon Linux comes with <a href="http://aws.amazon.com/amazon-linux-ami/2014.03-packages/">collectd-5.4.1</a> as an available RPM package.</p>

<p>Put this file into your project&rsquo;s <code>.ebextensions</code> directory.
Replace the <code>User</code> and <code>Password</code> fields with your credentials.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="c1"># .ebextensions/collectd.config</span>
</span><span class='line'><span class="l-Scalar-Plain">files</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="s">&quot;/etc/collectd.conf&quot;</span> <span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="s">&quot;000664&quot;</span>
</span><span class='line'>    <span class="l-Scalar-Plain">owner</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
</span><span class='line'>    <span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
</span><span class='line'>    <span class="l-Scalar-Plain">content</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
</span><span class='line'>      <span class="no">LoadPlugin syslog</span>
</span><span class='line'>      <span class="no">LoadPlugin cpu</span>
</span><span class='line'>      <span class="no">LoadPlugin interface</span>
</span><span class='line'>      <span class="no">LoadPlugin load</span>
</span><span class='line'>      <span class="no">LoadPlugin memory</span>
</span><span class='line'>      <span class="no">LoadPlugin write_http</span>
</span><span class='line'>      <span class="no">&lt;Plugin write_http&gt;</span>
</span><span class='line'>        <span class="no">&lt;URL &quot;https://collectd.librato.com/v1/measurements&quot;&gt;</span>
</span><span class='line'>          <span class="no">User &quot;user@example.com&quot;</span>
</span><span class='line'>          <span class="no">Password &quot;password&quot;</span>
</span><span class='line'>          <span class="no">Format &quot;JSON&quot;</span>
</span><span class='line'>        <span class="no">&lt;/URL&gt;</span>
</span><span class='line'>      <span class="no">&lt;/Plugin&gt;</span>
</span><span class='line'>      <span class="no">Include &quot;/etc/collectd.d&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">packages</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">yum</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">collectd</span><span class="p-Indicator">:</span> <span class="p-Indicator">[]</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">commands</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">start_collectd</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">killall collectd; collectdmon -c collectd</span>
</span></code></pre></td></tr></table></div></figure>


<p>Collectd will start reporting metrics to Librato when you deploy your application.</p>

<p>Then you can start building Librato instruments and dashboards that look like this:</p>

<p><img src="/images/collectd_cpu.png" alt="collectd CPU" /></p>

<p><img src="/images/collectd_dash.png" alt="collectd dash" /></p>

<h2>Summary</h2>

<p>At Thinknear, we strive to measure anything that will help us understand the behavior of our systems in production.
Collectd is a great tool for us to track instance level statistics that CloudWatch does not provide.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/22/unnecessary-complexity/">Unnecessary Complexity</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-22T17:20:18-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>5:20 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div align="center">
&#8220;Any intelligent fool can make things bigger, more complex, and more violent. It takes a touch of genius — and a lot of courage — to move in the opposite direction.&#8221; - Einstein
</div>


<p><p/>
Software development is hard.  That&rsquo;s a fact.  Not only do we have a product that we must enhance, develop from scratch,
or even maintain, but we have people&rsquo;s interactions, opinions, emotions, the list goes on.  And then there is design,
technology and execution.   All these factors, all these variables make software development the fantastic challenge
that it is.  And I love it.  At the same time, I am on a mission to remove complexity introduced into a system when it
need not be there.  The actual doing of this, making the decisions about what to include, what to leave out and to do
this consistently on a day to day basis is difficult.</p>

<p>As Product Owners and Engineers, we are faced with these decisions all the time as we work on a system.  Each decision,
from those more-complex-than-it-needs-to-be features to irreversible design decisions to that single line of code, all
have an impact on our productivity and agility.  Everybody talks about keeping it simple and taking a lean approach -
this is nothing new.  It is how we can achieve this when making those decisions on the ground that is the focus of this
blog.</p>

<p>There are at least five major areas where we love to introduce complexity: feature development, execution, design,
technology selection and code.</p>

<p>Here I want to go through a number of approaches that I have used that help prevent complexity being incurred because,
let&rsquo;s face it, the solution should only be as complex as the problem at hand.</p>

<h2>Unnecessary feature complexity</h2>

<p>The basic tenet of unnecessary feature complexity, especially when dealing with new product development,
is to answer the question &ldquo;What is the minimum we have to do to figure out if this is going to work?&rdquo; Again, nothing
new.  This is part of the Lean movement.  I&rsquo;m sure you have your own, but allow me to to offer the following approach
to exploring a new product or service:</p>

<ul>
<li>What is the minimum amount of work we need to do in order to have the initial conversation with the first client?

<ul>
<li>Rough idea on features available</li>
<li>Rough idea on tech, format, deployment and performance.  Discussion based, no documentation required.</li>
</ul>
</li>
<li>What is the minimum amount of work we need to do to sell to our first client?

<ul>
<li>Minimum Marketable Product (MMP) determined along with feasibility</li>
<li>More information about data required to be supplied and what would be returned.</li>
<li>NOT the API contract</li>
<li>(Internal only) Rough idea of implementation time to version 0.1 for first client.</li>
</ul>
</li>
<li>Once we have sold with delivery estimate to client:

<ul>
<li>Lock down API contract or feature set including success/failure scenarios - deliver early so client can start mocking
out from their end and write the integration code</li>
<li>Integration approach detailed</li>
<li>Deployment architecture detailed</li>
<li>Performance characteristics and design to support detailed</li>
<li>Implement and deliver MMP</li>
<li>Roadmap for any further features created based on initial usage (iterative and incremental)</li>
</ul>
</li>
</ul>


<p>Pretty straight forward, huh?  Yet we all know when we have done too much design after a product or idea has been put
on the backburner.  Ever thought &ldquo;We really didn&rsquo;t need to do that much work to make that decision to defer the product&rdquo;? Make the hard decisions now to save time later.</p>

<p>Of course, there are times when the above steps do not make sense, or they need to be modified.  For example,
when doing a legacy migration. There are likely many clients that rely on features already present in the legacy system. In these cases,
we can take the opportunity to evolve the clients during the migration and do some spring cleaning of
the legacy system, i.e. answer the questions &ldquo;What features do we really need?&rdquo; and &ldquo;What features have proven to not
be of value given what we know now about our business?&rdquo;  Unfortunately, as is most often the case, there are &ldquo;hidden&rdquo;
organic features that have no documentation that can trip us up.</p>

<h2>Unnecessary execution complexity</h2>

<p>There are many in this category, so let&rsquo;s just focus on a few:</p>

<ul>
<li>Break big problems down into smaller pieces:  Be exact with the acceptance criteria.  This one is self explanatory.</li>
<li>Business Accepting a story only when it is deployed and verified in production: This is a technique that <a href="http://mikquinlan.com/2013/07/28/no-more-burndown-no-more-definition-of-done/" target="_blank">I&rsquo;ve spoken about before.</a>
It encourages quality and promotes continuous deployment, a part of the Continuous Delivery strategy.</li>
<li>Keep to 1 week iterations if suitable: As long as there is a long term strategy, <a href="http://mikquinlan.com/2013/03/07/re-platforming-a-system-and-the-value-of-1-week-iterations/" target="_blank">1 week iterations</a>
give more opportunities to retrospect and force breaking down of stories into smaller component parts of business value while keeping the overall mission squarely in the centre of the picture.</li>
<li>Automate delivery:  Once we have small stories and iterative, incremental development, deploying manually,
especially if we are practicing BA&#8217;ing a story once it is in production, takes a lot of effort. Make the investment in
Continuous Delivery supported by automation, taking into account the aspects <a href="http://mikquinlan.com/2014/01/27/continuous-delivery-the-missing-piece-of-the-puzzle/" target="_blank">I have blogged about before</a>.
Micro Services are also a viable option (note: Micro Services is a bad name, IMO, a service should just be small enough to fit in our
headspace&hellip;but that is a topic for another blog).</li>
</ul>


<h2>Unnecessary design complexity</h2>

<p>Keep it simple. We all know the acronym. Here are some ideas to help focus development efforts:</p>

<ul>
<li>Limit the number of business strategies/initiatives an organisation takes on:  This could actually be a section all
on its own.  I have frequently been in organisations where multiple business strategies are pursued concurrently.<br/>
There is nothing wrong with pursuing multiple business strategies, but when it exhausts the capacity of the organisation,
then we end up with a lot of half done ideas that never gain the momentum they&rsquo;re supposed to due to not enough attention
being paid to them (market forces notwithstanding).  This then trickles down into design.  Design is hard.  We must
make sure we design within our capacity so we build something that will work and work well enough to fulfill the most
valuable strategic objectives that we carefully chose.</li>
<li>Keep designs incredibly straight forward wherever possible: Again, not a new concept, yet when on the ground how many
times have you looked at a design and thought &ldquo;that is waaaay too complex&rdquo;?  More than once, maybe?  Not every edge
case needs to be covered.  Work with the business to understand the acceptable levels of failure a system can have.<br/>
During design, when an edge case comes up, if it&rsquo;s technical weigh up the likelihood of occurrence vs the effort to fix.
Don&rsquo;t just dive in and fix it because it&rsquo;s there.  If it&rsquo;s a business edge case, work with the business to see if it
needs to be resolved or whether a failure is acceptable.  Again, make hard decisions here.  Overall, taking a little
longer to decide that a feature will not be implemented will save effort over a quick decision to do it then having
the entire team take on that complexity.</li>
</ul>


<h2>Unnecessary technology complexity</h2>

<p>Keep the learning curve as low as possible so that engineers have less to learn technologically and can focus on the
solutions implemented to create the product or service.  Whatever we can do to have them focus more on the problems
being solved rather than the different libraries we used to, say, create and access files can only be a good thing:</p>

<ul>
<li>Organisationally it is important to limit the technologies being used so we can build upon the knowledge acquired by
our fellow engineers.  If we have one NoSQL database, do we really need another?  For a technology selection where
NoSQL is deemed to be a good fit, it is important to come up with a reason why we cannot use a NoSQL technology that
is already in production within our organisation, along with all the libraries we have built around it.  Of course,
if that technology is not a fit, we then must be able to articulate the distinct advantages of the technology we want
to introduce.  Polyglot solutions are a good thing, applied judiciously.  Again, effort vs value.  In this case, effort
to de-risk, implement and build libraries/tools around the new technology vs value to the business.</li>
<li>Within a service it is important to limit the libraries used.  The number of libraries a single service can end up
using can be huge.  That huge effective pom.xml if you use Maven, that long list of gems.  Limit the libraries used for
a service so that engineers will not just reach for the library they know when facing a problem, adding to the burgeoning
list of libraries required for the project.</li>
</ul>


<h2>Unnecessary code/implementation complexity</h2>

<p>Have you ever looked at a codebase and seen multiple ways of achieving the same thing?  For example, file handling,
filtering specific objects out of lists etc.?  Yeah, me too.  It&rsquo;s important that we do common operations consistently
within a codebase (and across services&hellip;harder but still possible).  Agree within the team how this should be done
(use the <a href="https://code.google.com/p/guava-libraries/" target="_blank">Guava libraries</a>? <a href="http://commons.apache.org/" target="_blank">Apache Commons</a>? etc.)
and stick to it.  If you are an engineer and unsure, look at other parts of the codebase.  Common methods of handling
code results in less to learn and a decreased ramp up period for engineers new to it.</p>

<h2>A note on back end infrastructure systems vs front end product development</h2>

<p>Front end product development needs rapid delivery.  So we can&rsquo;t always live in a world where everything is consistent.  In these scenarios, agree among the team members the libraries to use, approach etc. and forge ahead developing the new product.  In this case, technical debt will ensue, but this is good technical debt.  In fact, we could say it is &ldquo;necessary&rdquo; technical debt. Necessary because not adding a feature can be as key to being first to market as adding a feature.</p>

<p>If the product or feature is successful and is moved from proof to long lived, address the technical debt that has been incurred.  This typically happens when a product gets traction and a company is coming out of the startup phase. A great blog that articulates technical debt is
<a href="http://blog.crisp.se/2013/10/11/henrikkniberg/good-and-bad-technical-debt" target="_blank">this one</a> by Henrik Kniberg.</p>

<h2>Summary</h2>

<p>I hope the above guidance helps.  Each of the bullet points could be a topic in itself, and I wanted this blog to be a collection of areas to consider.  If I was to sum this up in one sentence, it would be</p>

<p>&ldquo;Take just a little more time to make the hard decisions.&rdquo;</p>

<p>I am always looking for ways to make the development of software and, by extension, products easier, so I&rsquo;d be interested to know what strategies you use to limit complexity in a system. Feel free to leave a comment, below.</p>

<p>Aaaaand as I completed this, that lovely chap Dan North just released <a href="https://www.youtube.com/watch?v=XqgwHXsQA1g" target="_blank">this presentation</a>. :-)</p>

<p>Note: This is a modified cross post from one that originally appeared <a href="http://mikquinlan.com/2014/08/14/unnecessary-complexity/" target="_blank">here</a>.</p>

<p><strong>About the author</strong>: Mik Quinlan is Director of Engineering - Mobile Advertising at Thinknear by Telenav. He has
over 16 years experience architecting and implementing highly scalable, high throughput, low latency systems and
has led several Agile transformations at various companies. Connect via <a href="https://www.linkedin.com/in/mikquinlan" target="_blank">LinkedIn</a>
or <a href="https://twitter.com/mikquinlan" target="_blank">Twitter</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/20/welcome-to-thinknear-engineering/">Welcome to Thinknear Engineering</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-20T17:53:07-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This blog marks the beginning of the Thinknear Engineering presence on the internet.
<a href="http://thinknear.com/">Thinknear</a> started in 2011 and was acquired by <a href="http://www.telenav.com/">Telenav</a> in 2012.
Though we&rsquo;re part of a much larger public company, Thinknear maintains its distinct engineering culture and spirit.
We have been entirely cloud-based from the get-go (we&rsquo;re big users of AWS, Heroku, Librato, and more); we&rsquo;re very agile,
using a scrum-based internal development cycle; and we have a lot of fun, like with daily Halo breaks.</p>

<p>We also push the limits of what a small team can accomplish with today&rsquo;s technology.
We handle tens of thousands of requests per second across our fleet with very aggressive latency targets,
our hosts generate terabytes of data per day which we have to crunch with aggressive time goals,
we&rsquo;re running massive PostGIS queries, and we dabble in Angular.js as well.</p>

<p>On this blog, we will showcase our technology, expertise, open source contributions, and other things of interest to
distributed systems&#8217; engineers. We are really excited about what we do, and we hope to share our enthusiasm here.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/01/06/heroku-cost-savings-using-generic-workers/">Heroku Cost Optimization Using Generic Workers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/26/typical-friday-night/">Typical Friday Night</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/25/presenting-at-reinvent/">Presenting at re:Invent</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/11/aws-templates-released/">Aws_templates Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/11/tn-s3-file-uploader-released/">Tn_s3_file_uploader Released</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Thinknear by Telenav -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'thinknearengineering';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
